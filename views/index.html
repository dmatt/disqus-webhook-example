<!DOCTYPE html>
<html>
  <head>
    <title>Wistia Webhooks Demo</title>
    <meta name="description" content="How to use Disqus webhooks to build an app that subscribes to post and vote events in Disqus as they happen">
        <link rel="shortcut icon" href="//a.disquscdn.com/1540426646/img/favicon16-32.ico" type="image/vnd.microsoft.icon">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/style.css">
  </head>
  <body>
    
    <!-- Welcome note -->
    <p>
      Hi! This here's a demo of <a href="https://disqus.com/api/docs/forums/webhooks/">Disqus Webhooks</a>.
    </p>
    <p>
      Leave a comment or up/downvote below. Then, click the "Remix on Glitch" button to see the source and make it your own.
    </p>
    
    <div id="webhooks_log">
      <pre>
        <code class="log">
        </code>
      </pre>
    </div>
    
    <!-- Socket.IO -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.js"></script>

    <!-- highlight.js -->
    <link rel="stylesheet" href="highlighting.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
    
    <script>
      var webhooksLog = document.getElementById("webhooks_log");
      
      // make the empty code block a little pretty to start
      var codeBlock = document.getElementsByTagName("code")[0]
      hljs.highlightBlock(codeBlock);
      
      // as webhooks payloads come in from the server side via Socket.IO, we add them
      // to this `payloads` array, then stringify that data and show it on the page.
      window.payloads = [];
      var socket = io();
      socket.on('event', function(payload){
        payloads.unshift(payload);
        showPayloads(payloads);
      });
      
      function showPayloads(payloads) {
        webhooksLog.innerHTML = `<h3>Here are the payloads</h3>`;
        var code = document.createElement("code");
        code.className = "log"
        var pre = document.createElement("pre");
        pre.innerHTML = JSON.stringify(payloads, null, 2);
        code.appendChild(pre)
        webhooksLog.appendChild(code);
        hljs.highlightBlock(code);
      }
    </script>
    
    <!-- The Glitch button -->
    <div class="glitchButton" style="position:fixed;top:20px;right:20px;"></div>
    <script src="https://button.glitch.me/button.js"></script>
    <!-- A little script to add a "More [Team Name] Projects" button to that ðŸ‘† -->
    <script src="https://team-projects-button.glitch.me/js/team-projects-button.js"></script>
    
  </body>
</html>
